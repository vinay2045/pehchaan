<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ user.full_name or user.username }} - Pehchaan</title>
    <!-- Custom Redesign CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/profile_redesign.css') }}">
</head>

<body>

    <!-- Navigation -->
    <nav class="profile-nav">
        <div class="brand-group">
            <div class="logo">pehchaan</div>
            <div class="site-brand">{{ user.full_name or user.username }}</div>
        </div>
        <div class="nav-links">
            <a href="#about">About</a>
            {% if user.experiences %}
            <a href="#experience">Experience</a>
            {% endif %}
            <a href="#work">Work</a>
            {% if user.education %}
            <a href="#education">Education</a>
            {% endif %}
            {% if user.gallery_images %}
            <a href="#gallery">Gallery</a>
            {% endif %}
            {% if user.others %}
            <a href="#achievements">Achievements</a>
            {% endif %}
            <a href="#contact">Contact</a>
        </div>
    </nav>

    <!-- Banner (Prominent) -->
    {% if user.banner_image %}
    <div class="banner-section"
        style="background-image: url('{{ url_for('static', filename='uploads/' + user.banner_image) }}');"></div>
    {% else %}
    <div class="banner-section" style="background: linear-gradient(135deg, var(--yellow-bg), var(--green-bg));"></div>
    {% endif %}

    <!-- Hero Section -->
    <section class="hero-section">
        <div class="hero-content">
            {% if user.profile_image %}
            <div class="profile-image-container">
                <img src="{{ url_for('static', filename='uploads/' + user.profile_image) }}" alt="Profile"
                    class="profile-image">
            </div>
            {% else %}
            <div class="profile-image-container"
                style="background: var(--text-primary); display: flex; align-items: center; justify-content: center; color: var(--yellow-bg); font-size: 4rem;">
                {{ user.full_name[0] if user.full_name else user.username[0]|upper }}
            </div>
            {% endif %}

            <div class="hero-text">
                Hi, I'm {{ user.full_name or user.username }}, a
                <span>{{ user.profile_tag or 'Creative' }}</span> based in
                <span>{{ user.location or 'the World' }}</span>.
                {% if user.tagline %}
                <div style="font-size: 1.2rem; margin-top: 1rem; font-family: var(--font-sans); opacity: 0.8;">{{
                    user.tagline }}</div>
                {% endif %}
            </div>
        </div>
    </section>

    <!-- About / Skills / Bio -->
    <section id="about" class="content-section bg-white">
        <div class="section-header-about"
            style="margin-bottom: 3rem; display: flex; flex-direction: column; align-items: flex-start; ">
            <h2 class="section-title">About</h2>
            <div class="section-desc">
                {{ user.bio if user.bio else "A dedicated professional with a passion for creating impactful digital
                experiences." }}
            </div>
        </div>

        <!-- Skills Grid -->
        {% if user.skills %}
        <div style="margin-bottom: 4rem; ">
            <h3 style="font-size: 2rem; margin-bottom: 1.5rem; text-transform: uppercase;">Skills & Expertise</h3>
            <div class="skills-grid">
                {% for skill in user.skills %}
                <div class="skill-pill">{{ skill.name }}</div>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        <!-- Experience Timeline -->
        {% if user.experiences %}
        <div id="experience">
            <h3 style="font-size: 2rem; margin-bottom: 1.5rem; text-transform: uppercase;">Experience</h3>
            <div>
                {% for exp in user.experiences %}
                <div class="experience-item">
                    <div class="exp-date">{{ exp.start_date }} - {{ exp.end_date or 'Present' }}</div>
                    <div>
                        <div class="exp-company">{{ exp.company }}</div>
                        <div class="exp-role">{{ exp.role }}</div>
                        <p style="font-family: var(--font-sans); margin-top: 1rem; line-height: 1.6; opacity: 0.8;">{{
                            exp.description }}</p>

                        {% if exp.youtube_id %}
                        <div
                            style="margin-top: 1.5rem; width: 100%; aspect-ratio: 16/9; border: 2px solid var(--text-primary);">
                            <iframe width="100%" height="100%" src="https://www.youtube.com/embed/{{ exp.youtube_id }}"
                                frameborder="0" allowfullscreen></iframe>
                        </div>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}
    </section>

    <!-- Work Section -->
    <section id="work" class="work-section bg-green">
        <div class="section-header " style="padding: 0 3rem; margin-top: 4rem;">
            <h2 class="section-title">Work</h2>
            <div class="section-desc">Selected Projects</div>
        </div>

        <div class="project-grid">
            {% if user.projects %}
            {% for project in user.projects %}
            <div class="project-card">
                <div class="project-image-wrapper" style="--rotation: {{ range(-2, 2) | random }}deg;">
                    {% if project.youtube_id %}
                    <iframe width="100%" height="100%" src="https://www.youtube.com/embed/{{ project.youtube_id }}"
                        frameborder="0" allowfullscreen></iframe>
                    {% elif project.images %}
                    <img src="{{ url_for('static', filename='uploads/' + project.images[0].image_path) }}"
                        alt="{{ project.title }}" class="project-image" style="cursor: pointer;"
                        onclick="openLightbox(this.src)">
                    {% else %}
                    <div
                        style="width: 100%; height: 100%; background: #222; display: flex; align-items: center; justify-content: center; color: white;">
                        {{ project.title }}</div>
                    {% endif %}
                </div>
                <div class="project-tags">
                    {% if project.technologies %}
                    {{ project.technologies.split(',') | join(' / ') }}
                    {% endif %}
                </div>
                <h3 class="project-title">{{ project.title }}</h3>
                <p style="font-family: var(--font-sans); opacity: 0.8;">{{ project.description }}</p>
                <div style="margin-top: 1rem; font-weight: 600;">
                    {% if project.demo_url %}<a href="{{ project.demo_url }}" target="_blank"
                        style="margin-right: 1rem; color: var(--text-primary);">LIVE SITE ↗</a>{% endif %}
                    {% if project.github_url %}<a href="{{ project.github_url }}" target="_blank"
                        style="color: var(--text-primary);">GITHUB ↗</a>{% endif %}
                </div>
            </div>
            {% endfor %}
            {% else %}
            <p>No projects visible.</p>
            {% endif %}
        </div>
    </section>

    <!-- Achievements -->
    {% if user.gallery_images %}
    <section id="gallery" class="content-section bg-white">
        <div class="section-header">
            <h2 class="section-title">Gallery</h2>
            <div class="section-desc">Snapshots & Highlights</div>
        </div>
        <div class="project-grid">
            {% for image in user.gallery_images %}
            <div class="project-card">
                <div class="project-image-wrapper">
                    <img src="{{ url_for('static', filename='uploads/' + image.image_path) }}" class="project-image"
                        style="cursor: pointer;" onclick="openLightbox(this.src)">
                </div>
            </div>
            {% endfor %}
        </div>
    </section>
    {% endif %}

    <!-- Achievements -->
    {% if user.others %}
    <section id="achievements" class="content-section" style="background-color: var(--yellow-bg);">
        <div class="section-header">
            <h2 class="section-title">Awards</h2>
            <div class="section-desc">Recognitions & Certifications</div>
        </div>
        <div class="project-grid">
            {% for item in user.others %}
            <div class="project-card">
                <div class="project-image-wrapper" style="--rotation: {{ range(-2, 2) | random }}deg;">
                    {% if item.youtube_id %}
                    <iframe width="100%" height="100%" src="https://www.youtube.com/embed/{{ item.youtube_id }}"
                        frameborder="0" allowfullscreen></iframe>
                    {% elif item.images %}
                    <img src="{{ url_for('static', filename='uploads/' + item.images[0].image_path) }}"
                        class="project-image" style="cursor: pointer;" onclick="openLightbox(this.src)">
                    {% endif %}
                </div>
                <h3 class="project-title" style="font-size: 2rem;">{{ item.title }}</h3>
                <p>{{ item.description }}</p>
                {% if item.achieved_date %}
                <div style="font-style: italic; margin-top: 0.5rem;">{{ item.achieved_date }}</div>
                {% endif %}
            </div>
            {% endfor %}
        </div>
    </section>
    {% endif %}

    <!-- Education -->
    {% if user.education %}
    <section id="education" class="content-section"
        style="background-color: #FFDD00; border-top: 2px solid var(--text-primary);">
        <div class="section-header">
            <h2 class="section-title">Education</h2>
            <div class="section-desc">Academic Background</div>
        </div>
        <div>
            {% for edu in user.education %}
            <div class="experience-item"
                style="border-bottom: 1px solid rgba(0,0,0,0.1); padding-bottom: 2rem; margin-bottom: 2rem;">
                <div class="exp-date">{{ edu.start_date }} - {{ edu.end_date or 'Present' }}</div>
                <div>
                    <div class="exp-company" style="font-size: 1.5rem; font-weight: 700;">{{ edu.course }}</div>
                    <div class="exp-role">{{ edu.institute_name }}</div>
                    {% if edu.grade %}
                    <div style="font-weight: 600; margin-top: 0.5rem;">Grade: {{ edu.grade }}</div>
                    {% endif %}
                    {% if edu.description %}
                    <p style="font-family: var(--font-sans); margin-top: 1rem; line-height: 1.6; opacity: 0.8;">{{
                        edu.description }}</p>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        </div>
    </section>
    {% endif %}

    <!-- Contact Section -->
    <section id="contact" style="padding: 6rem 4rem; background-color: white;">
        <h2 class="section-title" style="font-size: 8rem; margin-bottom: 4rem;">Contact</h2>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 6rem; align-items: start;">

            <form method="POST" action="{{ url_for('profile.contact', username=user.username) }}" class="contact-form">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

                <div class="form-group">
                    <label>What's your name?</label>
                    <input type="text" name="name" class="form-control" placeholder="Jane Doe" required>
                </div>

                <div class="form-group">
                    <label>Your email address</label>
                    <input type="email" name="email" class="form-control" placeholder="jane@example.com" required>
                </div>

                <div class="form-group">
                    <label>Subject</label>
                    <input type="text" name="subject" class="form-control" placeholder="Project Inquiry" required>
                </div>

                <div class="form-group">
                    <label>Message</label>
                    <textarea name="message" class="form-control" rows="4" placeholder="Tell me about your project..."
                        required></textarea>
                </div>

                <button type="submit" class="btn-submit">
                    Send Message ↗
                </button>
            </form>

            <div style="padding-top: 2rem;">
                <h3 style="font-size: 2.5rem; margin-bottom: 2rem;">Connect</h3>
                <div style="margin-bottom: 3rem;">
                    <a href="mailto:{{ user.email }}"
                        style="font-size: 2rem; color: var(--text-primary); text-decoration: underline;">{{ user.email
                        }}</a>
                </div>

                {% if user.social_links %}
                <div style="display: flex; flex-direction: column; gap: 1rem;">
                    {% for link in user.social_links %}
                    <a href="{{ link.url }}" target="_blank"
                        style="font-size: 1.5rem; font-weight: 600; text-transform: uppercase; color: var(--text-primary); text-decoration: none; display: flex; align-items: center; gap: 0.5rem;">
                        {{ link.platform }} <span style="font-size: 1rem;">↗</span>
                    </a>
                    {% endfor %}
                </div>
                {% endif %}
            </div>
        </div>
    </section>

    <!-- Lightbox Modal -->
    <div id="lightboxModal" class="lightbox" onclick="closeLightbox()">
        <span class="lightbox-close">&times;</span>
        <img class="lightbox-content" id="lightboxImage">
        <div style="text-align: center; color: white; margin-top: 10px; font-family: var(--font-sans);">
            Click outside to close
        </div>
    </div>

    <!-- Lightbox Script -->
    <script>
        function openLightbox(src) {
            const modal = document.getElementById('lightboxModal');
            const img = document.getElementById('lightboxImage');

            if (!modal || !img) {
                console.error('Lightbox elements not found');
                return;
            }

            modal.style.display = "block";
            img.src = src;
            document.body.style.overflow = "hidden";
        }

        function closeLightbox() {
            const modal = document.getElementById('lightboxModal');
            if (modal) {
                modal.style.display = "none";
            }
            document.body.style.overflow = "auto";
        }

        // Close on ESC key
        document.addEventListener('keydown', function (event) {
            if (event.key === "Escape") {
                closeLightbox();
            }
        });
    </script>

</body>

</html>