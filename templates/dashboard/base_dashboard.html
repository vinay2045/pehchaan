{% extends "base.html" %}

{% block title %}Dashboard - Pehchaan{% endblock %}

{% block content %}
<style>
    @media (max-width: 768px) {
        .dashboard-layout {
            flex-direction: column;
        }

        .dashboard-sidebar {
            position: fixed;
            top: 0;
            left: -260px;
            /* Hide sidebar */
            width: 250px;
            height: 100%;
            z-index: 1000;
            transition: left 0.3s ease;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
        }

        .dashboard-sidebar.active {
            left: 0;
        }

        .dashboard-main {
            padding: var(--space-md) !important;
            width: 100%;
        }

        .mobile-header {
            display: flex !important;
        }

        .mobile-close-btn {
            display: block !important;
        }
    }

    .mobile-header {
        display: none;
        padding: var(--space-md);
        background: var(--bg-card);
        border-bottom: 2px solid var(--border-color);
        align-items: center;
        justify-content: space-between;
    }

    .sidebar-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 999;
    }

    .dashboard-sidebar.active+.sidebar-overlay {
        display: block;
    }
</style>

<div style="display: flex; min-height: 100vh;" class="dashboard-layout">
    <!-- Mobile Header -->
    <div class="mobile-header">
        <span style="font-weight: 700; font-size: 1.2rem;">pehchaan</span>
        <button onclick="toggleSidebar()"
            style="background:none; border:none; font-size: 1.5rem; cursor: pointer;">â˜°</button>
    </div>

    <!-- Sidebar -->
    <aside class="dashboard-sidebar"
        style="width: 250px; background-color: var(--bg-card); border-right: 2px solid var(--border-color); padding: var(--space-lg);">
        <div style="margin-bottom: var(--space-xl);">
            <a href="{{ url_for('main.index') }}" style="font-size: var(--font-size-xl); font-weight: 600;">pehchaan</a>
            <!-- Close button for mobile -->
            <button onclick="toggleSidebar()"
                style="float: right; display: none; background:none; border:none; font-size: 1.5rem;"
                class="mobile-close-btn">&times;</button>
        </div>

        <nav>
            <ul style="list-style: none;">
                <li style="margin-bottom: var(--space-sm);">
                    <a href="{{ url_for('dashboard.profile') }}" class="nav-link"
                        style="display: block; padding: var(--space-xs);">Profile</a>
                </li>

                {% if current_user.role == 'individual' %}
                <li style="margin-bottom: var(--space-sm);">
                    <a href="{{ url_for('dashboard.projects') }}" class="nav-link"
                        style="display: block; padding: var(--space-xs);">Projects</a>
                </li>
                <li style="margin-bottom: var(--space-sm);">
                    <a href="{{ url_for('dashboard.experience') }}" class="nav-link"
                        style="display: block; padding: var(--space-xs);">Experience</a>
                </li>
                <li style="margin-bottom: var(--space-sm);">
                    <a href="{{ url_for('dashboard.education') }}" class="nav-link"
                        style="display: block; padding: var(--space-xs);">Education</a>
                </li>
                {% endif %}

                {% if current_user.role == 'business' %}
                <li style="margin-bottom: var(--space-sm);">
                    <a href="{{ url_for('dashboard.services') }}" class="nav-link"
                        style="display: block; padding: var(--space-xs);">Services</a>
                </li>
                <li style="margin-bottom: var(--space-sm);">
                    <a href="{{ url_for('dashboard.previous_work') }}" class="nav-link"
                        style="display: block; padding: var(--space-xs);">Previous Work</a>
                </li>
                {% endif %}

                <li style="margin-bottom: var(--space-sm);">
                    <a href="{{ url_for('dashboard.gallery') }}" class="nav-link"
                        style="display: block; padding: var(--space-xs);">Gallery</a>
                </li>
                <li style="margin-bottom: var(--space-sm);">
                    <a href="{{ url_for('dashboard.others') }}" class="nav-link"
                        style="display: block; padding: var(--space-xs);">Others</a>
                </li>
                <li style="margin-bottom: var(--space-sm);">
                    <a href="{{ url_for('dashboard.messages') }}" class="nav-link"
                        style="display: block; padding: var(--space-xs);">Messages</a>
                </li>
                <li style="margin-bottom: var(--space-sm);">
                    <a href="{{ url_for('profile.view_profile', username=current_user.username) }}" class="nav-link"
                        style="display: block; padding: var(--space-xs);">View Profile</a>
                </li>
            </ul>
        </nav>

        <div style="margin-top: var(--space-xl);">
            <a href="{{ url_for('static', filename='qr_codes/' + current_user.username + '.png') }}"
                download="{{ current_user.username }}_qr.png" class="btn btn-yellow btn-small btn-block"
                style="margin-bottom: 12px; display: flex; align-items: center; justify-content: center; gap: 8px;">
                ðŸ“¥ Download QR
            </a>
            <a href="{{ url_for('auth.logout') }}" class="btn btn-outline btn-small btn-block">Logout</a>
        </div>
    </aside>
    <div class="sidebar-overlay" onclick="toggleSidebar()"></div>

    <!-- Main Content -->
    <main style="flex: 1; padding: var(--space-lg);">
        <div class="container-narrow">
            {% block dashboard_content %}
            <h1>Welcome, {{ current_user.full_name or current_user.username }}!</h1>
            <p>Complete your profile to get started.</p>
            <a href="{{ url_for('dashboard.profile') }}" class="btn btn-primary">Edit Profile</a>
            {% endblock %}
        </div>
    </main>
</div>
<script>
    function toggleSidebar() {
        document.querySelector('.dashboard-sidebar').classList.toggle('active');
    }
</script>
{% endblock %}