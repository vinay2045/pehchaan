{% extends "dashboard/base_dashboard.html" %}

{% block title %}Gallery - Dashboard{% endblock %}

{% block dashboard_content %}
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-md);">
    <h1>Gallery</h1>
</div>

<!--Upload Form -->
<div class="card" style="margin-bottom: var(--space-lg); text-align: center; padding: var(--space-xl);">
    <form method="POST" action="{{ url_for('dashboard.upload_gallery_image') }}" enctype="multipart/form-data"
        id="gallery-upload-form">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <label for="gallery-images" class="btn btn-primary" style="cursor: pointer; display: inline-block;">
            ðŸ“¤ Upload Images
        </label>
        <input type="file" name="images" id="gallery-images" accept="image/*" multiple style="display: none;"
            onchange="this.form.submit()">
        <p style="color: var(--text-muted); margin-top: 12px; font-size: 14px;">Select multiple images (JPG, PNG)</p>
    </form>
</div>

<!-- Gallery Grid -->
<div class="bento-grid">
    {% for image in images %}
    <div class="card" style="padding: 0; overflow: hidden; position: relative;">
        <img src="{{ url_for('static', filename='uploads/' + image.image_path) }}"
            style="width: 100%; height: 250px; object-fit: cover;">
        <button class="btn btn-outline btn-small" onclick="deleteGalleryImage({{ image.id }})"
            style="position: absolute; top: 12px; right: 12px; background: white; color: #dc3545;">
            Delete
        </button>
    </div>
    {% else %}
    <div class="card" style="text-align: center; padding: var(--space-xl); grid-column: 1 / -1;">
        <p style="color: var(--text-muted);">No images in gallery. Upload some images to get started!</p>
    </div>
    {% endfor %}
</div>
{% endblock %}

{% block extra_js %}
<script>
    function deleteGallery Image(imageId) {
        if (!confirm('Are you sure you want to delete this image?')) return;

        fetch(`/dashboard/gallery/${imageId}/delete`, { method: 'POST' })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    location.reload();
                }
            });
    }
</script>
{% endblock %}